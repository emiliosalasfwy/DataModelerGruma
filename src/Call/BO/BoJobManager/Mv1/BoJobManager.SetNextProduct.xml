<BusinessLogic methodName="setNextProduct" businessObjectClass="BoJobManager" accessibility="PUBLIC" final="false" module="CORE">
  <Parameters>
    <MethodInput name="direction" type="String" />
  </Parameters>
  <Code language="JavaScript"><![CDATA[

var me = this;
var loProducts = me.getLoCurrentSurveyProducts();

var liCurrent = loProducts.getCurrent();
var nextCurrent = null;

if (Utils.isDefined(liCurrent)) {
	if (direction === "previous") {
		nextCurrent = loProducts.getPreviousListItem(liCurrent);
	} else {
		nextCurrent = loProducts.getNextListItem(liCurrent);
	}

} else {
	nextCurrent = loProducts.getFirstItem();
}

if (Utils.isDefined(nextCurrent)) {
	loProducts.setCurrent(nextCurrent);
}

         ]]></Code>
</BusinessLogic>