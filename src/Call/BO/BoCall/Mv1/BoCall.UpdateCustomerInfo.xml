<BusinessLogic methodName="updateCustomerInfo" businessObjectClass="BoCall" businessObjectType="" asynchronous="true" accessibility="PUBLIC" final="false" module="CORE" simpleEditorOnly="">
  <Parameters>
    <MethodInput name="customerObjectStatus" type="Object" />
    <MethodInput name="saveFlag" type="String" />
  </Parameters>
<Code language="JavaScript">
<![CDATA[var promise;
//In release 3, no POS exists in Salesforce. Therefore, this function has been disabled using the isSfBackend()-Method.
//if dirty or customer has been saved
if((customerObjectStatus != STATE.PERSISTED || (!Utils.isEmptyString(saveFlag) && saveFlag == "1")) && !Utils.isSfBackend())
{
  //Update Customer Lookup
  promise = BoFactory.loadObjectAsync("LuCustomer", me.getBpaMainPKey())
    .then(function(lookup){
    me.setLuCustomer(lookup);
    //Update BoJobManager
    me.getBoJobManager().setCallInfo(me.getPKey(), me.getClbMetaPKey(), me.getClbStatus(), me.getBpaMainPKey(), me.getDateFrom(), me.getTimeFrom(), lookup.name, me.getLuCallMeta().getConsiderPOSCheck(), me.getLuCallMeta().getConsiderTargetValues());
    me.getBoJobManager().setLoPOSInvalidated("1");
  });
}
else
{
  promise = when.resolve();
}]]>
</Code>
  <Return name="returnName" value="promise" />
</BusinessLogic>