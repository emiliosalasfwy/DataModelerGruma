<BusinessLogic methodName="validateQuantitiesOfFreeItems" businessObjectClass="BoHurdleEvaluationHelper" businessObjectType="businessobject" asynchronous="false" accessibility="PUBLIC" final="false" module="CORE" simpleEditorOnly="">
  <Parameters>
    <MethodInput name="messageCollector" type="Object" />
  </Parameters>
<Code language="JavaScript">
<![CDATA[// Obsolete / unused : This function has been deprecated and moved to another BO - BoRewardProductValidation 

var currentRewardFreeProducts = me.getLoRewardProducts().getItems();
var maxQuantity = 0;

currentRewardFreeProducts.forEach(
  function(freeProduct) {
    var reward = me.getLoRewards().getItemByPKey(freeProduct.promotionReward);

    if(reward.getPerFactor() >= 1){
      maxQuantity = freeProduct.getMaxQuantityValue() * reward.getPerFactor();
    } else{
      maxQuantity = freeProduct.getMaxQuantityValue();
    }

    if(maxQuantity > 0 && freeProduct.getQuantity() > maxQuantity) {
      messageCollector.add({
        "level" : "error",
        "objectClass" : "BoHurdleEvaluationHelper",
        "simpleProperty": " ",
        "messageParams": {
          "productName" : freeProduct.getProductName() ,
          "maxQuantityValue": maxQuantity.toString()
        },
        "messageID" : "FreeProductsValidation_MaxValueExceeded",      
      });
    }
  }
);]]>
</Code>
  <Return name="messageCollector" value="messageCollector" />
</BusinessLogic>