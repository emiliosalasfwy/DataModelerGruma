<BusinessLogic methodName="validateTotalQuantityOfFreeItems" businessObjectClass="BoHurdleEvaluationHelper" businessObjectType="businessobject" asynchronous="false" accessibility="PUBLIC" final="false" module="CORE" simpleEditorOnly="">
  <Parameters>
    <MethodInput name="messageCollector" type="Object" />
  </Parameters>
<Code language="JavaScript">
<![CDATA[// Obsolete / unused : This function has been deprecated and moved to another BO - BoRewardProductValidation 

var currentRewardFreeProducts = me.getLoRewardProducts().getItems();
var reward = me.getLoRewards().getCurrent();
var maxItemsForReward;

if(reward.getPerFactor() >= 1){
  maxItemsForReward = reward.getDefaultValue() * reward.getPerFactor();
} else{
  maxItemsForReward = reward.getDefaultValue();
}

var totalQuantity = 0;
if(maxItemsForReward > 0) {
  currentRewardFreeProducts.forEach(
    function(freeProduct) { 	 
      totalQuantity += freeProduct.getQuantity();
    }
  );
  if(totalQuantity > maxItemsForReward) {
    messageCollector.add({
      "level" : "error",
      "objectClass" : "BoHurdleEvaluationHelper",
      "simpleProperty": " ",
      "messageID" : "FreeProductsValidation_totalMaxValueExceeded",      
    });
  }
}]]>
</Code>
  <Return name="messageCollector" value="messageCollector" />
</BusinessLogic>