<BusinessLogic methodName="getCriterionAttributeForLevel" businessObjectClass="BoOrderMeta" businessObjectType="" asynchronous="false" accessibility="PUBLIC" final="false" module="CORE" simpleEditorOnly="">
  <Parameters>
    <MethodInput name="level" type="String" />
  </Parameters>
<Code language="JavaScript">
<![CDATA[var criterionAttribute;

if ((me.getItemListOption() == "Hierarchy") && (me.getMobilityRelevant() == "1")) {
  var params = [];
  params.push({ "Level1": "All", "op": "NE" });
  params.push({ "Level1": "Basket", "op": "NE" });
  params.push({ "Level1": "New", "op": "NE" });
  params.push({ "Level1": "Promotion", "op": "NE" });
  params.push({ "Level1": "OutOfStock", "op": "NE" });
  params.push({ "Level1": "History", "op": "NE" });

  var productSelectorConfiguration = me.getLoProductSelector().getItemsByParamArray(params);

  if (productSelectorConfiguration.length > 0) {
    var productGroupLevel;

    switch (level) {
      case "1":
        productGroupLevel = productSelectorConfiguration[0].getLevel1();
        break;
      case "2":
        productGroupLevel = productSelectorConfiguration[0].getLevel2();
        break;
    }

    if (Utils.isDefined(productGroupLevel)) {
      var mappingItems = me.getLoPrdGroupLevelCriterionMapping().getItemsByParam({"groupLevel": productGroupLevel});

      if (mappingItems.length > 0) {
        criterionAttribute = mappingItems[0].getCriterion().toLowerCase();
      }
    }
  }
} else {
  // Fallback for not mobility relevant templates
  criterionAttribute = me.getCriterionAttributeForFlatList();
}]]>
</Code>
  <Return name="criterionAttribute" value="criterionAttribute" />
</BusinessLogic>