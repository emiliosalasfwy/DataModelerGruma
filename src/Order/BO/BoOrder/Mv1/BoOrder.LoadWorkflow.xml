<BusinessLogic methodName="loadWorkflow" businessObjectClass="BoOrder" businessObjectType="" asynchronous="true" accessibility="PUBLIC" final="false" module="CORE" simpleEditorOnly="">
  <Parameters />
  <Code language="JavaScript"><![CDATA[var promise = BoFactory.loadObjectByParamsAsync(BO_WORKFLOW, me.getQueryBy("pKey", me.getWfeWorkflowPKey())).then(
  function (boWorkflow) {
    me.setBoWorkflow(boWorkflow);

    //Only relevant for orders: Release button must only be visible if next state is Released
    me.setIsNextStateRelease('0');
    if(!Utils.isEmptyString(me.getBoOrderMeta().getWfeWorkflowPKey())){
      var nextStates = me.getBoWorkflow().getNextStates(me.getActualStatePKey());

      if (nextStates.length > 0 && nextStates[0].stateType.toLowerCase() === "released") {
        me.setIsNextStateRelease('1');
      }
    }
  });]]></Code>
  <Return name="result" value="promise" />
</BusinessLogic>