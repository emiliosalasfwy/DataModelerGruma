<BusinessLogic methodName="onQuestionChanged" businessObjectClass="BoTour" businessObjectType="businessobject" asynchronous="false" accessibility="PUBLIC" final="false" module="CORE" simpleEditorOnly="">
  <Parameters>
    <MethodInput name="handlerParams" type="Object" />
  </Parameters>
<Code language="JavaScript">
<![CDATA[var listItem = handlerParams.listItem;
var value;
var stateNewDirty = STATE.NEW | STATE.DIRTY;

if((me.getLoTourChecks().getObjectStatus() === STATE.PERSISTED || me.getLoTourChecks().getObjectStatus() === 1) && me.getLoTourChecks().getObjectStatus() !== stateNewDirty){
  Framework.getProcessContext().tourDetail.getLoTourChecks().setObjectStatus(STATE.DIRTY);
}

//Set Question on New Tour creation
if(me.getObjectStatus() == stateNewDirty){
  var tourCheckColumnPkey = handlerParams.listItem.getPKey().slice(0,16);
  var usage = handlerParams.listItem.getUsage();
  if(Utils.isDefined(me.getLoTmgTourCheckRelations)){
    var liTourChecksRelItems = me.getLoTmgTourCheckRelations().getAllItems();
    if(liTourChecksRelItems.length > 0){
      for (var i = 0; i < liTourChecksRelItems.length; i++) {
        var liTourCheckRelItem = liTourChecksRelItems[i];
        if(liTourCheckRelItem.getTmgCheckPKey() == tourCheckColumnPkey && liTourCheckRelItem.getUsage() == usage && Utils.isDefined(value)){
          if(value == "1"){
            liTourCheckRelItem.setValue("1");
          }
          else{
            liTourCheckRelItem.setValue("0");
          }
          break;
        }
      }
    }
  }
}]]>
</Code>
  <Return name="" value="" />
</BusinessLogic>