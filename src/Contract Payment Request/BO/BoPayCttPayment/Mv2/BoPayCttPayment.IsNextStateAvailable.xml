<BusinessLogic methodName="isNextStateAvailable" businessObjectClass="BoPayCttPayment" businessObjectType="" asynchronous="false" accessibility="PUBLIC" final="false" module="CORE" simpleEditorOnly="">
  <Parameters>
    <MethodInput name="stateType" type="String" />
  </Parameters>
<Code language="JavaScript">
<![CDATA[var usrMainPKey = ApplicationContext.get('user').getPKey();
var nextStates = me.getBoWorkflow().getNextStatesByStateType(me.getActualStatePKey(), stateType);
var luManagement = me.getLuCustomerManagementInfo();
var managementInfo = ((me.getResponsiblePKey() == usrMainPKey) && (luManagement.getHasSubstitute() == "0")) || ((luManagement.getHasSubstitute() == "1") && (luManagement.getHasSubstituteUsrMainPKey() == usrMainPKey));
var visible = (nextStates.length > 0 && managementInfo);]]>
</Code>
  <Return name="result" value="visible" />
</BusinessLogic>